
<table>
<!-- table header : clients-->
    <tr>
        <td/>
        <td class="out">outputs</td>

        {% for clientName, clientData in clients.items()
           if clientData.output| length != 0%}
            <td colspan="{{clientData.output | length}}"><b>{{clientName}}</b></td>
        {% endfor %}
    </tr>
    <!-- sub table header : outputs -->
    <tr>
        <td class="in">inputs</td>
        <td/>
            {% for clientName, clientData in clients.items() %}
                {% for output in  clientData.output %}
                    <td class="out">{{output }}</td>
                {% endfor %}
            {% endfor %}
    </tr>
    <!-- one row per input-->

    {% for clientName, clientData in clients.items()
       if clientData.input | length != 0%}
        <tr>
            <td rowspan="{{clientData.input | length }}">
                <b>{{clientName}}</b>
            </td>
            {% for input in  clientData.input %}
                {% if not loop.first%}
                    <tr>
                {% endif %}
                    <td class="in"> {{input }}</td>
                    <!-- connections -->
                        {% for oClientName, oClientData in clients.items()
                           if oClientData.output| length != 0%}
                            {% for oPortName, oPortData in oClientData.output.items() %}
                                {% set connected = [] %}
                                <td class="connection">
                                    <form action="/" method="post">
                                        <input type="hidden"
                                               name="input"
                                               value="{{clientName}}:{{input}}">
                                        <input type="hidden"
                                               name="output"
                                               value="{{oClientName}}:{{oPortName}}">
                                        {% for con in oPortData.connections %}
                                            {% if con ==
                                                  clientName + ":" + input %}
                                                <input type="hidden"
                                                       name="state"
                                                       value="disconnect">
                                                <a href='#'
                                                   onclick='this.parentNode.submit()'>X</a>
                                                <!-- workaround to set a var -->
                                                {% if connected.append(1) %}{% endif %}
                                            {% endif %}
                                        {% endfor %}
                                        {% if not connected %}
                                            <input type="hidden"
                                                   name="state"
                                                   value="connect">
                                            <a href='#'
                                               onclick='this.parentNode.submit()'>0</a>
                                        {% endif %}
                                    </form>
                                </td>
                            {% endfor %}
                        {% endfor %}
                    </tr>
                {% endfor %}
            {% endfor %}
</table>
