(this.webpackJsonpdrawable_canvas=this.webpackJsonpdrawable_canvas||[]).push([[0],{19:function(t,e,n){t.exports=n(36)},32:function(t,e){},33:function(t,e){},34:function(t,e){},35:function(t,e,n){},36:function(t,e,n){"use strict";n.r(e);var o=n(7),r=n.n(o),a=n(17),s=n.n(a),i=n(6),c=n(13),u=n(8),f=n(0),h=n(3),l=n(1),v=n(2),d=function t(e){Object(f.a)(this,t),this._canvas=void 0,this._canvas=e},b=function(t){Object(l.a)(n,t);var e=Object(v.a)(n);function n(){var t;Object(f.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))).isMouseDown=!1,t.fillColor="#ffffff",t.strokeWidth=10,t.strokeColor="#ffffff",t.currentCircle=new u.fabric.Circle,t.currentStartX=0,t.currentStartY=0,t.linearDistance=function(t,e){var n=e.x-t.x,o=e.y-t.y;return Math.sqrt(n*n+o*o)},t}return Object(h.a)(n,[{key:"configureCanvas",value:function(t){var e=this;this._canvas.isDrawingMode=!1,this._canvas.selection=!1,this._canvas.forEachObject((function(t){return t.selectable=t.evented=!1}));var n=t.strokeWidth,o=t.strokeColor,r=t.fillColor;return this.strokeWidth=n,this.strokeColor=o,this.fillColor=r,this._canvas.on("mouse:down",(function(t){return e.onMouseDown(t)})),this._canvas.on("mouse:move",(function(t){return e.onMouseMove(t)})),this._canvas.on("mouse:up",(function(t){return e.onMouseUp(t)})),this._canvas.on("mouse:out",(function(t){return e.onMouseOut(t)})),function(){e._canvas.off("mouse:down"),e._canvas.off("mouse:move"),e._canvas.off("mouse:up"),e._canvas.off("mouse:out")}}},{key:"onMouseDown",value:function(t){var e=this._canvas;this.isMouseDown=!0;var n=e.getPointer(t.e);this.currentStartX=n.x,this.currentStartY=n.y,this.currentCircle=new u.fabric.Circle({left:this.currentStartX,top:this.currentStartY,originX:"left",originY:"center",strokeWidth:this.strokeWidth,stroke:this.strokeColor,fill:this.fillColor,selectable:!1,evented:!1,radius:1}),e.add(this.currentCircle)}},{key:"onMouseMove",value:function(t){if(this.isMouseDown){var e=this._canvas,n=e.getPointer(t.e);this.currentCircle.set({radius:this.linearDistance({x:this.currentStartX,y:this.currentStartY},{x:n.x,y:n.y})/2,angle:180*Math.atan2(n.y-this.currentStartY,n.x-this.currentStartX)/Math.PI}),this.currentCircle.setCoords(),e.renderAll()}}},{key:"onMouseUp",value:function(t){this.isMouseDown=!1}},{key:"onMouseOut",value:function(t){this.isMouseDown=!1}}]),n}(d),w=function(t){Object(l.a)(n,t);var e=Object(v.a)(n);function n(){return Object(f.a)(this,n),e.apply(this,arguments)}return Object(h.a)(n,[{key:"configureCanvas",value:function(t){var e=t.strokeWidth,n=t.strokeColor;return this._canvas.isDrawingMode=!0,this._canvas.freeDrawingBrush.width=e,this._canvas.freeDrawingBrush.color=n,function(){}}}]),n}(d),g=function(t){Object(l.a)(n,t);var e=Object(v.a)(n);function n(){var t;Object(f.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))).isMouseDown=!1,t.strokeWidth=10,t.strokeColor="#ffffff",t.currentLine=new u.fabric.Line,t}return Object(h.a)(n,[{key:"configureCanvas",value:function(t){var e=this;this._canvas.isDrawingMode=!1,this._canvas.selection=!1,this._canvas.forEachObject((function(t){return t.selectable=t.evented=!1}));var n=t.strokeWidth,o=t.strokeColor;return this.strokeWidth=n,this.strokeColor=o,this._canvas.on("mouse:down",(function(t){return e.onMouseDown(t)})),this._canvas.on("mouse:move",(function(t){return e.onMouseMove(t)})),this._canvas.on("mouse:up",(function(t){return e.onMouseUp(t)})),this._canvas.on("mouse:out",(function(t){return e.onMouseOut(t)})),function(){e._canvas.off("mouse:down"),e._canvas.off("mouse:move"),e._canvas.off("mouse:up"),e._canvas.off("mouse:out")}}},{key:"onMouseDown",value:function(t){var e=this._canvas;this.isMouseDown=!0;var n=e.getPointer(t.e),o=[n.x,n.y,n.x,n.y];this.currentLine=new u.fabric.Line(o,{strokeWidth:this.strokeWidth,fill:this.strokeColor,stroke:this.strokeColor,originX:"center",originY:"center",selectable:!1,evented:!1}),e.add(this.currentLine)}},{key:"onMouseMove",value:function(t){if(this.isMouseDown){var e=this._canvas,n=e.getPointer(t.e);this.currentLine.set({x2:n.x,y2:n.y}),this.currentLine.setCoords(),e.renderAll()}}},{key:"onMouseUp",value:function(t){this.isMouseDown=!1}},{key:"onMouseOut",value:function(t){this.isMouseDown=!1}}]),n}(d),M=function(t){Object(l.a)(n,t);var e=Object(v.a)(n);function n(){var t;Object(f.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))).isMouseDown=!1,t.fillColor="#ffffff",t.strokeWidth=10,t.strokeColor="#ffffff",t.currentRect=new u.fabric.Rect,t.currentStartX=0,t.currentStartY=0,t}return Object(h.a)(n,[{key:"configureCanvas",value:function(t){var e=this;this._canvas.isDrawingMode=!1,this._canvas.selection=!1,this._canvas.forEachObject((function(t){return t.selectable=t.evented=!1}));var n=t.strokeWidth,o=t.strokeColor,r=t.fillColor;return this.strokeWidth=n,this.strokeColor=o,this.fillColor=r,this._canvas.on("mouse:down",(function(t){return e.onMouseDown(t)})),this._canvas.on("mouse:move",(function(t){return e.onMouseMove(t)})),this._canvas.on("mouse:up",(function(t){return e.onMouseUp(t)})),this._canvas.on("mouse:out",(function(t){return e.onMouseOut(t)})),function(){e._canvas.off("mouse:down"),e._canvas.off("mouse:move"),e._canvas.off("mouse:up"),e._canvas.off("mouse:out")}}},{key:"onMouseDown",value:function(t){var e=this._canvas;this.isMouseDown=!0;var n=e.getPointer(t.e);this.currentStartX=n.x,this.currentStartY=n.y,this.currentRect=new u.fabric.Rect({left:this.currentStartX,top:this.currentStartY,originX:"left",originY:"top",width:n.x-this.currentStartX,height:n.y-this.currentStartY,stroke:this.strokeColor,strokeWidth:this.strokeWidth,fill:this.fillColor,transparentCorners:!1,selectable:!1,evented:!1,strokeUniform:!0,noScaleCache:!1,angle:0}),e.add(this.currentRect)}},{key:"onMouseMove",value:function(t){if(this.isMouseDown){var e=this._canvas,n=e.getPointer(t.e);this.currentStartX>n.x&&this.currentRect.set({left:Math.abs(n.x)}),this.currentStartY>n.y&&this.currentRect.set({top:Math.abs(n.y)}),this.currentRect.set({width:Math.abs(this.currentStartX-n.x)}),this.currentRect.set({height:Math.abs(this.currentStartY-n.y)}),this.currentRect.setCoords(),e.renderAll()}}},{key:"onMouseUp",value:function(t){this.isMouseDown=!1}},{key:"onMouseOut",value:function(t){this.isMouseDown=!1}}]),n}(d),k=function(t){Object(l.a)(n,t);var e=Object(v.a)(n);function n(){return Object(f.a)(this,n),e.apply(this,arguments)}return Object(h.a)(n,[{key:"configureCanvas",value:function(t){var e=this._canvas;e.isDrawingMode=!1,e.selection=!0,e.forEachObject((function(t){return t.selectable=t.evented=!0}));var n=function(){e.remove(e.getActiveObject())};return e.on("mouse:dblclick",n),function(){e.off("mouse:dblclick",n)}}}]),n}(d);function m(t){t.renderAll();var e=t.getContext().getImageData(0,0,t.getWidth(),t.getHeight()),n=Array.from(e.data);c.a.setComponentValue({data:n,width:e.width,height:e.height,raw:t.toObject()})}var C=Object(c.b)((function(t){var e=t.args,n=e.canvasWidth,a=e.canvasHeight,s=e.backgroundColor,f=e.backgroundImage,h=e.updateStreamlit,l=e.drawingMode,v=Object(o.useState)(new u.fabric.Canvas("")),d=Object(i.a)(v,2),C=d[0],_=d[1],y=Object(o.useState)(new u.fabric.StaticCanvas("")),p=Object(i.a)(y,2),O=p[0],j=p[1];return Object(o.useEffect)((function(){var t=new u.fabric.Canvas("c",{enableRetinaScaling:!1}),e=new u.fabric.StaticCanvas("imgC",{enableRetinaScaling:!1});_(t),j(e),c.a.setFrameHeight()}),[a,n]),Object(o.useEffect)((function(){if(C){C.setBackgroundColor(s,(function(){if(f){var t=O.getContext().createImageData(n,a);t.data.set(f),O.getContext().putImageData(t,0,0)}m(C)})),c.a.setFrameHeight();var t={circle:new b(C),freedraw:new w(C),line:new g(C),rect:new M(C),transform:new k(C)}[l].configureCanvas(e),o=function(){m(C)},r=h?["mouse:up","selection:cleared","selection:updated","object:removed","object:modified"]:[];return r.forEach((function(t){return C.on(t,o)})),function(){t(),r.forEach((function(t){return C.off(t,o)}))}}})),r.a.createElement("div",{style:{position:"relative"}},r.a.createElement("div",{style:{position:"absolute",top:0,left:0,zIndex:0}},r.a.createElement("canvas",{id:"imgC",width:n,height:a})),r.a.createElement("div",{style:{position:"absolute",top:0,left:0,zIndex:10}},r.a.createElement("canvas",{id:"c",width:n,height:a})))}));n(35);s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(C,null)),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.4e30395c.chunk.js.map