/*
 * Copyright (c) 2020. - Arash Hatami
 */

!function(){var requirejs,require,define;!function(e){function t(e,t){return x.call(e,t)}function n(e,t){var n,r,i,a,o,s,c,l,p,u,d,f,m=t&&t.split("/"),h=v.map,g=h&&h["*"]||{};if(e){for(e=e.split("/"),o=e.length-1,v.nodeIdCompat&&b.test(e[o])&&(e[o]=e[o].replace(b,"")),"."===e[0].charAt(0)&&m&&(f=m.slice(0,m.length-1),e=f.concat(e)),p=0;p<e.length;p++)if("."===(d=e[p]))e.splice(p,1),p-=1;else if(".."===d){if(0===p||1===p&&".."===e[2]||".."===e[p-1])continue;p>0&&(e.splice(p-1,2),p-=2)}e=e.join("/")}if((m||g)&&h){for(n=e.split("/"),p=n.length;p>0;p-=1){if(r=n.slice(0,p).join("/"),m)for(u=m.length;u>0;u-=1)if((i=h[m.slice(0,u).join("/")])&&(i=i[r])){a=i,s=p;break}if(a)break;!c&&g&&g[r]&&(c=g[r],l=p)}!a&&c&&(a=c,s=l),a&&(n.splice(0,s,a),e=n.join("/"))}return e}function r(t,n){return function(){var r=w.call(arguments,0);return"string"!=typeof r[0]&&1===r.length&&r.push(null),u.apply(e,r.concat([t,n]))}}function i(e){return function(t){return n(t,e)}}function a(e){return function(t){m[e]=t}}function o(n){if(t(h,n)){var r=h[n];delete h[n],g[n]=!0,p.apply(e,r)}if(!t(m,n)&&!t(g,n))throw new Error("No "+n);return m[n]}function s(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function c(e){return e?s(e):[]}function l(e){return function(){return v&&v.config&&v.config[e]||{}}}var p,u,d,f,m={},h={},v={},g={},x=Object.prototype.hasOwnProperty,w=[].slice,b=/\.js$/;d=function(e,t){var r,a=s(e),c=a[0],l=t[1];return e=a[1],c&&(c=n(c,l),r=o(c)),c?e=r&&r.normalize?r.normalize(e,i(l)):n(e,l):(e=n(e,l),a=s(e),c=a[0],e=a[1],c&&(r=o(c))),{f:c?c+"!"+e:e,n:e,pr:c,p:r}},f={require:function(e){return r(e)},exports:function(e){var t=m[e];return void 0!==t?t:m[e]={}},module:function(e){return{id:e,uri:"",exports:m[e],config:l(e)}}},p=function(n,i,s,l){var p,u,v,x,w,b,k,y=[],j=typeof s;if(l=l||n,b=c(l),"undefined"===j||"function"===j){for(i=!i.length&&s.length?["require","exports","module"]:i,w=0;w<i.length;w+=1)if(x=d(i[w],b),"require"===(u=x.f))y[w]=f.require(n);else if("exports"===u)y[w]=f.exports(n),k=!0;else if("module"===u)p=y[w]=f.module(n);else if(t(m,u)||t(h,u)||t(g,u))y[w]=o(u);else{if(!x.p)throw new Error(n+" missing "+u);x.p.load(x.n,r(l,!0),a(u),{}),y[w]=m[u]}v=s?s.apply(m[n],y):void 0,n&&(p&&p.exports!==e&&p.exports!==m[n]?m[n]=p.exports:v===e&&k||(m[n]=v))}else n&&(m[n]=s)},requirejs=require=u=function(t,n,r,i,a){if("string"==typeof t)return f[t]?f[t](n):o(d(t,c(n)).f);if(!t.splice){if(v=t,v.deps&&u(v.deps,v.callback),!n)return;n.splice?(t=n,n=r,r=null):t=e}return n=n||function(){},"function"==typeof r&&(r=i,i=a),i?p(e,t,n,r):setTimeout(function(){p(e,t,n,r)},4),u},u.config=function(e){return u(e)},requirejs._defined=m,define=function(e,n,r){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");n.splice||(r=n,n=[]),t(m,e)||t(h,e)||(h[e]=[e,n,r])},define.amd={jQuery:!0}}(),define("components/almond/almond",function(){}),define("app/lib/ready",[],function(){"use strict";var e=!1,t=function(t){e||(e=!0,t())};return function(e){document.addEventListener("DOMContentLoaded",function(){t(e)}),"interactive"!==document.readyState&&"complete"!==document.readyState||t(e)}}),define("app/config",[],function(){"use strict";for(var e={css:!0,lang:(navigator.language||navigator.userLanguage).split("-")[0],"reply-to-self":!1,"require-email":!1,"require-author":!1,"reply-notifications":!1,"max-comments-top":"inf","max-comments-nested":5,"reveal-on-click":5,gravatar:!1,avatar:!0,"avatar-bg":"#f0f0f0","avatar-fg":["#9abf88","#5698c4","#e279a3","#9163b6","#be5168","#f19670","#e4bf80","#447c69"].join(" "),vote:!0,"vote-levels":null,feed:!1},t=document.getElementsByTagName("script"),n=0;n<t.length;n++)for(var r=0;r<t[n].attributes.length;r++){var i=t[n].attributes[r];if(/^data-nikas-/.test(i.name))try{e[i.name.substring(11)]=JSON.parse(i.value)}catch(t){e[i.name.substring(11)]=i.value}}return e["avatar-fg"]=e["avatar-fg"].split(" "),e}),define("app/i18n/fa",{"postbox-text":"متن نظر را اینجا وارد کنید - حداقل ۳ حرف","postbox-author":"نام (اختیاری)","postbox-email":"آدرس ایمیل (اختیاری)","postbox-website":"آدرس وب سایت (اختیاری)","postbox-preview":"پیش نمایش","postbox-edit":"ویرایش","postbox-submit":"ثبت","postbox-notification":"Subscribe to email notification of replies","num-comments":"One Comment\n{{ n }} Comments","no-comments":"هنوز نظری ثبت نشده است","atom-feed":"Atom feed","comment-reply":"پاسخ","comment-edit":"ویرایش","comment-save":"ذخیره","comment-delete":"حذف","comment-confirm":"تایید","comment-close":"بستن","comment-cancel":"لغو","comment-deleted":"نظر حذف شد.","comment-queued":"در انتظار بررسی توسط مدیریت.","comment-anonymous":"ناشناس","comment-hidden":"{{ n }} Hidden","date-now":"همین الان","date-minute":"یک دقیقه پیش\n{{ n }} دقیقه پیش","date-hour":"یک ساعت پیش\n{{ n }} ساعت پیش","date-day":"دیروز\n{{ n }} روز پیش","date-week":"هفته پیش\n{{ n }} هفته پیش","date-month":"ماه پیش\n{{ n }} ماه پیش","date-year":"سال پیش\n{{ n }} سال پیش"}),define("app/i18n",["app/config","app/i18n/fa"],function(e,t){"use strict";var n=function(e){switch(e){case"fa":return function(e,t){return e[1===t?0:1]};default:return null}},r=e.lang;n(r)||(r="fa");var i={fa:t},a=n(r),o=function(n){return e[n+"-text-"+r]||i[r][n]||t[n]||"???"};return{lang:r,translate:o,pluralize:function(e,t){var n;return n=o(e),n.indexOf("\n")>-1&&(n=a(n.split("\n"),+t)),n?n.replace("{{ n }}",+t):n}}}),define("app/lib/promise",[],function(){"use strict";var e=function(e){console.log(e)},t=function(){this.success=[],this.errors=[]};t.prototype.then=function(t,n){this.success.push(t),n?this.errors.push(n):this.errors.push(e)};var n=function(){this.promise=new t};n.prototype={promise:t,resolve:function(e){this.promise.success.forEach(function(t){window.setTimeout(function(){t(e)},0)})},reject:function(e){this.promise.errors.forEach(function(t){window.setTimeout(function(){t(e)},0)})}};var r=function(e,n){return e instanceof t?e.then(n):n(e)};return{defer:function(){return new n},when:r}}),define("app/globals",[],function(){"use strict";var e=function(){this.values=[]};return e.prototype.update=function(e){this.values.push((new Date).getTime()-e.getTime())},e.prototype.localTime=function(){return new Date((new Date).getTime()-this.values.reduce(function(e,t){return e+t})/this.values.length)},{offset:new e}}),define("app/api",["app/lib/promise","app/globals"],function(e,t){"use strict";for(var n,r,i=function(){return window.location.pathname},a=document.getElementsByTagName("script"),o=0;o<a.length;o++)if(a[o].hasAttribute("data-nikas")){r=a[o].getAttribute("data-nikas");break}if(!r){for(o=0;o<a.length;o++)if(a[o].getAttribute("async")||a[o].getAttribute("defer"))throw"Nikas's automatic configuration detection failed, please refer to client-configuration and add a custom `data-nikas` attribute.";n=a[a.length-1],r=n.src.substring(0,n.src.length-"/js/embed.min.js".length)}"/"===r[r.length-1]&&(r=r.substring(0,r.length-1));var s=function(e,n,r,i,a){function o(){var e=s.getResponseHeader("Date");null!==e&&t.offset.update(new Date(e));var n=s.getResponseHeader("X-Set-Cookie");n&&n.match(/^nikas-/)&&(document.cookie=n),s.status>=500?a&&a(s.body):i({status:s.status,body:s.responseText})}var s=new XMLHttpRequest;try{s.open(e,n,!0),s.withCredentials=!0,s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){4===s.readyState&&o()}}catch(e){(a||console.log)(e.message)}s.send(r)},c=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&null!==e[n]&&void 0!==e[n]&&(t+=n+"="+encodeURIComponent(e[n])+"&");return t.substring(0,t.length-1)};return{endpoint:r,salt:"Eech7co8Ohloopo9Ol6baimi",create:function(t,n){var a=e.defer();return s("POST",r+"/new?"+c({uri:t||i()}),JSON.stringify(n),function(e){201===e.status||202===e.status?a.resolve(JSON.parse(e.body)):a.reject(e.body)}),a.promise},modify:function(t,n){var i=e.defer();return s("PUT",r+"/id/"+t,JSON.stringify(n),function(e){403===e.status?i.reject("Not authorized to modify this comment!"):200===e.status?i.resolve(JSON.parse(e.body)):i.reject(e.body)}),i.promise},remove:function(t){var n=e.defer();return s("DELETE",r+"/id/"+t,null,function(e){403===e.status?n.reject("Not authorized to remove this comment!"):200===e.status?n.resolve(null===JSON.parse(e.body)):n.reject(e.body)}),n.promise},view:function(t,n){var i=e.defer();return s("GET",r+"/id/"+t+"?"+c({plain:n}),null,function(e){i.resolve(JSON.parse(e.body))}),i.promise},fetch:function(t,n,a,o,l){void 0===n&&(n="inf"),void 0===a&&(a="inf"),void 0===o&&(o=null);var p={uri:t||i(),after:l,parent:o};"inf"!==n&&(p.limit=n),"inf"!==a&&(p.nested_limit=a);var u=e.defer();return s("GET",r+"/?"+c(p),null,function(e){200===e.status?u.resolve(JSON.parse(e.body)):404===e.status?u.resolve({total_replies:0}):u.reject(e.body)}),u.promise},count:function(t){var n=e.defer();return s("POST",r+"/count",JSON.stringify(t),function(e){200===e.status?n.resolve(JSON.parse(e.body)):n.reject(e.body)}),n.promise},like:function(t){var n=e.defer();return s("POST",r+"/id/"+t+"/like",null,function(e){n.resolve(JSON.parse(e.body))}),n.promise},dislike:function(t){var n=e.defer();return s("POST",r+"/id/"+t+"/dislike",null,function(e){n.resolve(JSON.parse(e.body))}),n.promise},feed:function(e){return r+"/feed?"+c({uri:e||i()})},preview:function(t){var n=e.defer();return s("POST",r+"/preview",JSON.stringify({text:t}),function(e){200===e.status?n.resolve(JSON.parse(e.body).text):n.reject(e.body)}),n.promise}}}),define("app/dom",[],function(){"use strict";function e(e){this.obj=e,this.replace=function(t){var r=n.htmlify(t);return e.parentNode.replaceChild(r.obj,e),r},this.prepend=function(t){var r=n.htmlify(t);return e.insertBefore(r.obj,e.firstChild),r},this.append=function(t){var r=n.htmlify(t);return e.appendChild(r.obj),r},this.insertAfter=function(t){var r=n.htmlify(t);return e.parentNode.insertBefore(r.obj,e.nextSibling),r},this.on=function(t,n,r){e.addEventListener(t,function(e){n(e),(void 0===r||r)&&e.preventDefault()})},this.toggle=function(e,n,r){var i=new t(n,r);this.on(e,function(){i.next()})},this.detach=function(){return e.parentNode.removeChild(this.obj),this},this.remove=function(){e.parentNode.removeChild(this.obj)},this.show=function(){e.style.display="block"},this.hide=function(){e.style.display="none"},this.setText=function(t){e.textContent=t},this.setHtml=function(t){e.innerHTML=t},this.blur=function(){e.blur()},this.focus=function(){e.focus()},this.scrollIntoView=function(t){e.scrollIntoView(t)},this.checked=function(){return e.checked},this.setAttribute=function(t,n){e.setAttribute(t,n)},this.getAttribute=function(t){return e.getAttribute(t)},this.classList=e.classList,Object.defineProperties(this,{textContent:{get:function(){return e.textContent},set:function(t){e.textContent=t}},innerHTML:{get:function(){return e.innerHTML},set:function(t){e.innerHTML=t}},value:{get:function(){return e.value},set:function(t){e.value=t}},placeholder:{get:function(){return e.placeholder},set:function(t){e.placeholder=t}}})}var t=function(e,t){this.state=!1,this.next=function(){this.state?(this.state=!1,t(this)):(this.state=!0,e(this))},this.wait=function(){this.state=!this.state}},n=function(t,n,r){void 0===r&&(r=!0),n||(n=window.document),n instanceof e&&(n=n.obj);var i=[].slice.call(n.querySelectorAll(t),0);return 0===i.length?null:1===i.length&&r?new e(i[0]):(i=[].slice.call(i,0),i.map(function(t){return new e(t)}))};return n.htmlify=function(t){if(t instanceof e)return t;if(t instanceof window.Element)return new e(t);var r=n.new("div");return r.innerHTML=t,new e(r.firstChild)},n.new=function(e,t){var n=document.createElement(e.split(".")[0]);return e.split(".").slice(1).forEach(function(e){n.classList.add(e)}),["A","LINK"].indexOf(n.nodeName)>-1&&(n.href="#"),t||0===t||(t=""),["TEXTAREA","INPUT"].indexOf(n.nodeName)>-1?n.value=t:n.textContent=t,n},n.each=function(e,t){Array.prototype.forEach.call(document.getElementsByTagName(e),t)},n}),define("app/utils",["app/i18n"],function(e){"use strict";var t,n=function(e){return(document.cookie.match("(^|; )"+e+"=([^;]*)")||0)[2]},r=function(e,t,n){return n=n||"0",e+="",e.length>=t?e:new Array(t-e.length+1).join(n)+e},i=function(t,n){var r=(t.getTime()-n.getTime())/1e3;(isNaN(r)||r<0)&&(r=0);var i=Math.floor(r/60),a=Math.floor(i/60),o=Math.floor(a/24);return r<=45&&e.translate("date-now")||r<=90&&e.pluralize("date-minute",1)||i<=45&&e.pluralize("date-minute",i)||i<=90&&e.pluralize("date-hour",1)||a<=22&&e.pluralize("date-hour",a)||a<=36&&e.pluralize("date-day",1)||o<=5&&e.pluralize("date-day",o)||o<=8&&e.pluralize("date-week",1)||o<=21&&e.pluralize("date-week",Math.floor(o/7))||o<=45&&e.pluralize("date-month",1)||o<=345&&e.pluralize("date-month",Math.floor(o/30))||o<=547&&e.pluralize("date-year",1)||e.pluralize("date-year",Math.floor(o/365.25))},a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},o=function(e){return String(e).replace(/[&<>"'\/]/g,function(e){return a[e]})},s=function(e){var t=document.createElement("div");return t.innerHTML=e.replace(/<div><br><\/div>/gi,"<br>").replace(/<div>/gi,"<br>").replace(/<br>/gi,"\n").replace(/&nbsp;/gi," "),t.textContent.trim()},c=function(e){return e=o(e),e.replace(/\n\n/gi,"<br><div><br></div>").replace(/\n/gi,"<br>")};try{localStorage.setItem("x","y"),localStorage.removeItem("x"),t=localStorage}catch(e){t=function(e){return{setItem:function(t,n){e[t]=n},getItem:function(t){return void 0!==e[t]?e[t]:null},removeItem:function(t){delete e[t]}}}({})}return{cookie:n,pad:r,ago:i,text:s,detext:c,localStorageImpl:t}}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("libjs-jade-runtime",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.jade=e()}}(function(){return function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!s&&c)return c(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var p=n[o]={exports:{}};t[o][0].call(p.exports,function(e){var n=t[o][1][e];return i(n||e)},p,p.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){"use strict";function r(e){return null!=e&&""!==e}function i(e){return(Array.isArray(e)?e.map(i):e&&"object"==typeof e?Object.keys(e).filter(function(t){return e[t]}):[e]).filter(r).join(" ")}function a(e){return s[e]||e}function o(e){var t=String(e).replace(c,a);return t===""+e?e:t}n.merge=function e(t,n){if(1===arguments.length){for(var i=t[0],a=1;a<t.length;a++)i=e(i,t[a]);return i}var o=t.class,s=n.class;(o||s)&&(o=o||[],s=s||[],Array.isArray(o)||(o=[o]),Array.isArray(s)||(s=[s]),t.class=o.concat(s).filter(r));for(var c in n)"class"!=c&&(t[c]=n[c]);return t},n.joinClasses=i,n.cls=function(e,t){for(var r=[],a=0;a<e.length;a++)t&&t[a]?r.push(n.escape(i([e[a]]))):r.push(i(e[a]));var o=i(r);return o.length?' class="'+o+'"':""},n.style=function(e){return e&&"object"==typeof e?Object.keys(e).map(function(t){return t+":"+e[t]}).join(";"):e},n.attr=function(e,t,r,i){return"style"===e&&(t=n.style(t)),"boolean"==typeof t||null==t?t?" "+(i?e:e+'="'+e+'"'):"":0==e.indexOf("data")&&"string"!=typeof t?(-1!==JSON.stringify(t).indexOf("&")&&console.warn("Since Jade 2.0.0, ampersands (`&`) in data attributes will be escaped to `&amp;`"),t&&"function"==typeof t.toISOString&&console.warn("Jade will eliminate the double quotes around dates in ISO form after 2.0.0")," "+e+"='"+JSON.stringify(t).replace(/'/g,"&apos;")+"'"):r?(t&&"function"==typeof t.toISOString&&console.warn("Jade will stringify dates in ISO form after 2.0.0")," "+e+'="'+n.escape(t)+'"'):(t&&"function"==typeof t.toISOString&&console.warn("Jade will stringify dates in ISO form after 2.0.0")," "+e+'="'+t+'"')},n.attrs=function(e,t){var r=[],a=Object.keys(e);if(a.length)for(var o=0;o<a.length;++o){var s=a[o],c=e[s];"class"==s?(c=i(c))&&r.push(" "+s+'="'+c+'"'):r.push(n.attr(s,c,!1,t))}return r.join("")};var s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"},c=/[&<>"]/g;n.escape=o,n.rethrow=function t(n,r,i,a){if(!(n instanceof Error))throw n;if(!("undefined"==typeof window&&r||a))throw n.message+=" on line "+i,n;try{a=a||e("fs").readFileSync(r,"utf8")}catch(e){t(n,null,i)}var o=3,s=a.split("\n"),c=Math.max(i-o,0),l=Math.min(s.length,i+o),o=s.slice(c,l).map(function(e,t){var n=t+c+1;return(n==i?"  > ":"    ")+n+"| "+e}).join("\n");throw n.path=r,n.message=(r||"Jade")+":"+i+"\n"+o+"\n\n"+n.message,n},n.DebugItem=function(e,t){this.lineno=e,this.filename=t}},{fs:2}],2:[function(e,t,n){},{}]},{},[1])(1)}),define("jade",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("jade!app/text/postbox",function(){var e=function(e){return function(t){var n,r=[],i=t||{};return function(t,i,a,o){r.push('<div class="nikas-postbox"><div class="form-wrapper"><div class="textarea-wrapper"><div contenteditable="true" class="textarea placeholder">'+e.escape(null==(n=a("postbox-text"))?"":n)+'</div><div class="preview"><div class="nikas-comment"><div class="text-wrapper"><div class="text"></div></div></div></div></div><section class="auth-section"><p class="input-wrapper"><input type="text" name="author"'+e.attr("placeholder",a("postbox-author"),!0,!1)+e.attr("value",null!==t?""+t:"",!0,!1)+'/></p><p class="input-wrapper"><input type="email" name="email"'+e.attr("placeholder",a("postbox-email"),!0,!1)+e.attr("value",null!=i?""+i:"",!0,!1)+'/></p><p class="input-wrapper"><input type="text" name="website"'+e.attr("placeholder",a("postbox-website"),!0,!1)+e.attr("value",null!=o?""+o:"",!0,!1)+'/></p><p class="post-action"><input type="submit"'+e.attr("value",a("postbox-submit"),!0,!1)+'/></p><p class="post-action"><input type="button" name="preview"'+e.attr("value",a("postbox-preview"),!0,!1)+'/></p><p class="post-action"><input type="button" name="edit"'+e.attr("value",a("postbox-edit"),!0,!1)+'/></p></section><section class="notification-section"><label><input type="checkbox" name="notification"/>'+e.escape(null==(n=a("postbox-notification"))?"":n)+"</label></section></div></div>")}.call(this,"author"in i?i.author:"undefined"!=typeof author?author:void 0,"email"in i?i.email:"undefined"!=typeof email?email:void 0,"i18n"in i?i.i18n:"undefined"!=typeof i18n?i18n:void 0,"website"in i?i.website:"undefined"!=typeof website?website:void 0),r.join("")}};return e.compiled=!0,e}),define("jade!app/text/comment",function(){var e=function(e){return function(t){var n,r=[],i=t||{};return function(t,i,a,o,s,c,l){r.push("<div"+e.attr("id","nikas-"+i.id,!0,!1)+' class="nikas-comment">'),a.gravatar&&r.push('<div class="avatar"><img'+e.attr("src",""+i.gravatar_image,!0,!1)+"/></div>"),a.avatar&&r.push('<div class="avatar"><svg'+e.attr("data-hash",""+i.hash,!0,!1)+"></svg></div>"),r.push('<div class="text-wrapper"><div role="meta" class="nikas-comment-header">'),t(i.website)?r.push("<a"+e.attr("href",""+i.website,!0,!1)+' rel="nofollow" class="author">'+e.escape(null==(n=t(i.author)?i.author:c("comment-anonymous"))?"":n)+"</a>"):r.push('<span class="author">'+e.escape(null==(n=t(i.author)?i.author:c("comment-anonymous"))?"":n)+"</span>"),r.push('<span class="spacer">&bull;</span><a'+e.attr("href","#nikas-"+i.id,!0,!1)+' class="permalink"><time'+e.attr("title",""+s(i.created),!0,!1)+e.attr("datetime",""+o(i.created),!0,!1)+'></time></a><span class="note">'+e.escape(null==(n=2==i.mode?c("comment-queued"):4==i.mode?c("comment-deleted"):"")?"":n)+'</span></div><div class="text">'),4==i.mode?r.push("<p>&nbsp;</p>"):r.push(null==(n=i.text)?"":n),r.push('</div><div class="nikas-comment-footer">'),a.vote&&r.push('<a href="#" class="upvote">'+(null==(n=l["arrow-up"])?"":n)+'</a><span class="spacer">|</span><a href="#" class="downvote">'+(null==(n=l["arrow-down"])?"":n)+"</a>"),r.push('<a href="#" class="reply">'+e.escape(null==(n=c("comment-reply"))?"":n)+'</a><a href="#" class="edit">'+e.escape(null==(n=c("comment-edit"))?"":n)+'</a><a href="#" class="delete">'+e.escape(null==(n=c("comment-delete"))?"":n)+'</a></div><div class="nikas-follow-up"></div></div></div>')}.call(this,"bool"in i?i.bool:"undefined"!=typeof bool?bool:void 0,"comment"in i?i.comment:"undefined"!=typeof comment?comment:void 0,"conf"in i?i.conf:"undefined"!=typeof conf?conf:void 0,"datetime"in i?i.datetime:"undefined"!=typeof datetime?datetime:void 0,"humanize"in i?i.humanize:"undefined"!=typeof humanize?humanize:void 0,"i18n"in i?i.i18n:"undefined"!=typeof i18n?i18n:void 0,"svg"in i?i.svg:"undefined"!=typeof svg?svg:void 0),r.join("")}};return e.compiled=!0,e}),define("jade!app/text/comment-loader",function(){var e=function(e){return function(t){var n,r=[],i=t||{};return function(t,i){r.push("<div"+e.attr("id","nikas-loader-"+t.name,!0,!1)+' class="nikas-comment-loader"><a href="#" class="load_hidden">'+e.escape(null==(n=i("comment-hidden",t.hidden_replies))?"":n)+"</a></div>")}.call(this,"comment"in i?i.comment:"undefined"!=typeof comment?comment:void 0,"pluralize"in i?i.pluralize:"undefined"!=typeof pluralize?pluralize:void 0),r.join("")}};return e.compiled=!0,e}),define("app/jade",["libjs-jade-runtime","app/utils","jade!app/text/postbox","jade!app/text/comment","jade!app/text/comment-loader"],function(runtime,utils,tt_postbox,tt_comment,tt_comment_loader){"use strict";var globals={},templates={},load=function(name,js){templates[name]=function(jade){var fn;return js.compiled?js(jade):(eval("fn = "+js),fn)}(runtime)},set=function(e,t){globals[e]=t};return load("postbox",tt_postbox),load("comment",tt_comment),load("comment-loader",tt_comment_loader),set("bool",function(e){return!!e}),set("humanize",function(e){return"object"!=typeof e&&(e=new Date(1e3*parseInt(e,10))),e.toString()}),set("datetime",function(e){return"object"!=typeof e&&(e=new Date(1e3*parseInt(e,10))),[e.getUTCFullYear(),utils.pad(e.getUTCMonth(),2),utils.pad(e.getUTCDay(),2)].join("-")+"T"+[utils.pad(e.getUTCHours(),2),utils.pad(e.getUTCMinutes(),2),utils.pad(e.getUTCSeconds(),2)].join(":")+"Z"}),{set:set,render:function(e,t){var n;if(!templates[e])throw new Error("Template not found: '"+e+"'");t=t||{};var r=[];for(var i in t)t.hasOwnProperty(i)&&!globals.hasOwnProperty(i)&&(r.push(i),globals[i]=t[i]);n=templates[e](globals);for(var a=0;a<r.length;a++)delete globals[r[a]];return n}}}),define("app/lib/editor",["app/dom","app/i18n"],function(e,t){"use strict";return function(n){return n=e.htmlify(n),n.setAttribute("contentEditable",!0),n.on("focus",function(){n.classList.contains("placeholder")&&(n.innerHTML="",n.classList.remove("placeholder"))}),n.on("blur",function(){0===n.textContent.length&&(n.textContent=t.translate("postbox-text"),n.classList.add("placeholder"))}),n}}),define("app/lib/identicons",["app/lib/promise","app/config"],function(e,t){"use strict";var n=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},r=function(e,t,n,r,i,a){var o=document.createElementNS("http://www.w3.org/2000/svg","rect");o.setAttribute("x",r+t*i),o.setAttribute("y",r+n*i),o.setAttribute("width",i),o.setAttribute("height",i),o.setAttribute("style","fill: "+a),e.appendChild(o)},i=function(i,a,o){var s=document.createElementNS("http://www.w3.org/2000/svg","svg");return s.setAttribute("version","1.1"),s.setAttribute("viewBox","0 0 "+o+" "+o),s.setAttribute("preserveAspectRatio","xMinYMin meet"),s.setAttribute("shape-rendering","crispEdges"),r(s,0,0,0,o+2*a,t["avatar-bg"]),null===typeof i?s:(e.when(i,function(e){var i=n((parseInt(e.substr(-16),16)%Math.pow(2,18)).toString(2),18),o=0;s.setAttribute("data-hash",e);for(var c=parseInt(i.substring(i.length-3,i.length),2),l=t["avatar-fg"][c%t["avatar-fg"].length],p=0;p<Math.ceil(2.5);p++)for(var u=0;u<5;u++)"1"===i.charAt(o)&&(r(s,p,u,a,8,l),p<Math.floor(2.5)&&r(s,4-p,u,a,8,l)),o++}),s)};return{generate:i,blank:function(e,t){var n=parseInt([0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,0].join(""),2).toString(16),r=i(n,e,t);return r.setAttribute("className","blank"),r}}}),define("app/lib",["require","app/lib/editor","app/lib/identicons"],function(e){return{editorify:e("app/lib/editor"),identicons:e("app/lib/identicons")}}),define("app/nikas",["app/dom","app/utils","app/config","app/api","app/jade","app/i18n","app/lib","app/globals"],function(e,t,n,r,i,a,o,s){"use strict";var c=function(a){var s=t.localStorageImpl,c=e.htmlify(i.render("postbox",{author:JSON.parse(s.getItem("author")),email:JSON.parse(s.getItem("email")),website:JSON.parse(s.getItem("website")),preview:""}));c.onsuccess=function(){},c.validate=function(){return t.text(e(".textarea",this).innerHTML).length<3||e(".textarea",this).classList.contains("placeholder")?(e(".textarea",this).focus(),!1):n["require-email"]&&e("[name='email']",this).value.length<=0?(e("[name='email']",this).focus(),!1):!(n["require-author"]&&e("[name='author']",this).value.length<=0)||(e("[name='author']",this).focus(),!1)};var l=function(){n["reply-notifications"]&&e("[name='email']",c).value.length>0?e(".notification-section",c).show():e(".notification-section",c).hide()};e("[name='email']",c).on("input",l),l(),n["require-email"]&&e("[name='email']",c).setAttribute("placeholder",e("[name='email']",c).getAttribute("placeholder").replace(/ \(.*\)/,"")),n["require-author"]&&(e("[name='author']",c).placeholder=e("[name='author']",c).placeholder.replace(/ \(.*\)/,"")),e("[name='preview']",c).on("click",function(){r.preview(t.text(e(".textarea",c).innerHTML)).then(function(t){e(".preview .text",c).innerHTML=t,c.classList.add("preview-mode")})});var u=function(){e(".preview .text",c).innerHTML="",c.classList.remove("preview-mode")};return e("[name='edit']",c).on("click",u),e(".preview",c).on("click",u),e("[type=submit]",c).on("click",function(){if(u(),c.validate()){var n=e("[name=author]",c).value||null,i=e("[name=email]",c).value||null,o=e("[name=website]",c).value||null;s.setItem("author",JSON.stringify(n)),s.setItem("email",JSON.stringify(i)),s.setItem("website",JSON.stringify(o)),r.create(e("#nikas-thread").getAttribute("data-nikas-id"),{author:n,email:i,website:o,text:t.text(e(".textarea",c).innerHTML),parent:a||null,title:e("#nikas-thread").getAttribute("data-title")||null,notification:e("[name=notification]",c).checked()?1:0}).then(function(t){e(".textarea",c).innerHTML="",e(".textarea",c).blur(),p(t,!0),null!==a&&c.onsuccess()})}}),o.editorify(e(".textarea",c)),c},l=function(t,a){var o;null===t.id?(o=e("#nikas-root"),t.name="null"):(o=e("#nikas-"+t.id+" > .text-wrapper > .nikas-follow-up"),t.name=t.id);var s=e.htmlify(i.render("comment-loader",{comment:t}));o.append(s),e("a.load_hidden",s).on("click",function(){s.remove(),r.fetch(e("#nikas-thread").getAttribute("data-nikas-id"),n["reveal-on-click"],n["max-comments-nested"],t.id,a).then(function(e){if(0!==e.total_replies){var t=0;e.replies.forEach(function(e){p(e,!1),e.created>t&&(t=e.created)}),e.hidden_replies>0&&l(e,t)}},function(e){console.log(e)})})},p=function(u,d){var f=e.htmlify(i.render("comment",{comment:u})),m=function(){e(".permalink > time",f).textContent=t.ago(s.offset.localTime(),new Date(1e3*parseInt(u.created,10))),setTimeout(m,6e4)};m(),n.avatar&&e("div.avatar > svg",f).replace(o.identicons.generate(u.hash,4,48));var h;h=e(null===u.parent?"#nikas-root":"#nikas-"+u.parent+" > .text-wrapper > .nikas-follow-up"),h.append(f),d&&f.scrollIntoView();var v=e("#nikas-"+u.id+" > .text-wrapper > .nikas-comment-footer"),g=e("#nikas-"+u.id+" > .text-wrapper > .nikas-comment-header"),x=e("#nikas-"+u.id+" > .text-wrapper > .text"),w=null;if(e("a.reply",v).toggle("click",function(t){w=v.insertAfter(new c(null===u.parent?u.id:u.parent)),w.onsuccess=function(){t.next()},e(".textarea",w).focus(),e("a.reply",v).textContent=a.translate("comment-close")},function(){w.remove(),e("a.reply",v).textContent=a.translate("comment-reply")}),n.vote){var b=n["vote-levels"];"string"==typeof b&&(b=b.split(","));var k=function(t){var n=e("span.votes",v);if(null===n?v.prepend(e.new("span.votes",t)):n.textContent=t,t?f.classList.remove("nikas-no-votes"):f.classList.add("nikas-no-votes"),b)for(var r=!0,i=0;i<=b.length;i++)r&&(i>=b.length||t<b[i])?(f.classList.add("nikas-vote-level-"+i),r=!1):f.classList.remove("nikas-vote-level-"+i)};e("a.upvote",v).on("click",function(){r.like(u.id).then(function(e){k(e.likes-e.dislikes)})}),e("a.downvote",v).on("click",function(){r.dislike(u.id).then(function(e){k(e.likes-e.dislikes)})}),k(u.likes-u.dislikes)}e("a.edit",v).toggle("click",function(i){var s=e("a.edit",v),c=n.avatar||n.gravatar?e(".avatar",f,!1)[0]:null;s.textContent=a.translate("comment-save"),s.insertAfter(e.new("a.cancel",a.translate("comment-cancel"))).on("click",function(){i.canceled=!0,i.next()}),i.canceled=!1,r.view(u.id,1).then(function(n){var r=o.editorify(e.new("div.textarea"));r.innerHTML=t.detext(n.text),r.focus(),x.classList.remove("text"),x.classList.add("textarea-wrapper"),x.textContent="",x.append(r)}),null!==c&&c.hide()},function(i){var o=e(".textarea",x),s=n.avatar||n.gravatar?e(".avatar",f,!1)[0]:null;if(i.canceled||null===o)x.innerHTML=u.text;else{if(t.text(o.innerHTML).length<3)return o.focus(),void i.wait();r.modify(u.id,{text:t.text(o.innerHTML)}).then(function(e){x.innerHTML=e.text,u.text=e.text})}x.classList.remove("textarea-wrapper"),x.classList.add("text"),null!==s&&s.show(),e("a.cancel",v).remove(),e("a.edit",v).textContent=a.translate("comment-edit")}),e("a.delete",v).toggle("click",function(t){var n=e("a.delete",v),r=!t.state;n.textContent=a.translate("comment-confirm"),n.on("mouseout",function(){n.textContent=a.translate("comment-delete"),t.state=r,n.onmouseout=null})},function(){var t=e("a.delete",v);r.remove(u.id).then(function(n){n?f.remove():(e("span.note",g).textContent=a.translate("comment-deleted"),x.innerHTML="<p>&nbsp;</p>",e("a.edit",v).remove(),e("a.delete",v).remove()),t.textContent=a.translate("comment-delete")})});var y=function(n){t.cookie("nikas-"+u.id)?setTimeout(function(){y(n)},15e3):null!==e(n,v)&&e(n,v).remove()};y("a.edit"),y("a.delete");var j=function(e){t.cookie("nikas-"+u.id)?setTimeout(function(){j(e)},15e3):v.append(e)};if(!n["reply-to-self"]&&t.cookie("nikas-"+u.id)&&j(e("a.reply",v).detach()),u.hasOwnProperty("replies")){var T=0;u.replies.forEach(function(e){p(e,!1),e.created>T&&(T=e.created)}),u.hidden_replies>0&&l(u,T)}};return{insert:p,insert_loader:l,Postbox:c}}),define("app/count",["app/api","app/dom","app/i18n"],function(e,t,n){return function(){var r={};t.each("a",function(e){if(e.href.match&&e.href.match(/#nikas-thread$/)){var t=e.getAttribute("data-nikas-id")||e.href.match(/^(.+)#nikas-thread$/)[1].replace(/^.*\/\/[^\/]+/,"");t in r?r[t].push(e):r[t]=[e]}});var i=Object.keys(r);e.count(i).then(function(e){for(var t in r)if(r.hasOwnProperty(t))for(var a=i.indexOf(t),o=0;o<r[t].length;o++)r[t][o].textContent=n.pluralize("num-comments",e[a])})}}),define("text",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("text!app/../../css/nikas.css",[],function(){
return'/* @import "https://cdn.jsdelivr.net/npm/vazir-font@26.0.2/dist/Farsi-Digits/font-face-FD.css"; */\r\n\r\n:root {\r\n    --font: "Vazir FD", Georgia, "Times New Roman", Times, serif;\r\n}\r\n\r\n#nikas-thread * {\r\n    -webkit-box-sizing: border-box;\r\n    -moz-box-sizing: border-box;\r\n    box-sizing: border-box;\r\n    font-family: var(--font);\r\n}\r\n\r\n#nikas-thread .nikas-comment-header a {\r\n    text-decoration: none;\r\n}\r\n\r\n#nikas-thread {\r\n    padding: 0;\r\n    margin: 0;\r\n    font-family: var(--font);\r\n}\r\n\r\n#nikas-thread > h4 {\r\n    color: #555;\r\n    font-weight: bold;\r\n    text-align: right;\r\n    direction: rtl;\r\n}\r\n\r\n#nikas-thread > .nikas-feedlink {\r\n    float: right;\r\n    padding-left: 1em;\r\n}\r\n\r\n#nikas-thread > .nikas-feedlink > a {\r\n    font-size: 0.8em;\r\n    vertical-align: bottom;\r\n}\r\n\r\n#nikas-thread .textarea {\r\n    min-height: 58px;\r\n    outline: 0;\r\n    color: black;\r\n    direction: rtl;\r\n}\r\n\r\n#nikas-thread .textarea.placeholder {\r\n    color: #757575;\r\n    direction: rtl;\r\n}\r\n\r\n#nikas-root {\r\n    direction: rtl;\r\n}\r\n\r\n#nikas-root .nikas-comment {\r\n    max-width: 68em;\r\n    padding-top: 0.95em;\r\n    margin: 0.95em auto;\r\n}\r\n\r\n#nikas-root .preview .nikas-comment {\r\n    padding-top: 0;\r\n    margin: 0;\r\n}\r\n\r\n#nikas-root .nikas-comment:not(:first-of-type),\r\n.nikas-follow-up .nikas-comment {\r\n    border-top: 1px solid rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.nikas-comment > div.avatar {\r\n    display: block;\r\n    width: 7%;\r\n    float: right;\r\n    margin: 3px 0 0 15px;\r\n}\r\n\r\n.nikas-comment > div.avatar > svg {\r\n    max-width: 48px;\r\n    max-height: 48px;\r\n    border-radius: 15px;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper {\r\n    display: block;\r\n}\r\n\r\n.nikas-comment .nikas-follow-up {\r\n    padding-left: unset;\r\n    padding-right: calc(7% + 20px);\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > .nikas-comment-header,\r\n.nikas-comment > div.text-wrapper > .nikas-comment-footer {\r\n    font-size: 0.95em;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > .nikas-comment-header {\r\n    font-size: 0.85em;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > .nikas-comment-header .spacer {\r\n    padding: 0 6px;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > .nikas-comment-header .spacer,\r\n.nikas-comment > div.text-wrapper > .nikas-comment-header a.permalink,\r\n.nikas-comment > div.text-wrapper > .nikas-comment-header .note,\r\n.nikas-comment > div.text-wrapper > .nikas-comment-header a.parent {\r\n    color: gray !important;\r\n    font-weight: normal;\r\n    text-shadow: none !important;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > .nikas-comment-header .spacer:hover,\r\n.nikas-comment > div.text-wrapper > .nikas-comment-header a.permalink:hover,\r\n.nikas-comment > div.text-wrapper > .nikas-comment-header .note:hover,\r\n.nikas-comment > div.text-wrapper > .nikas-comment-header a.parent:hover {\r\n    color: #606060 !important;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > .nikas-comment-header .note {\r\n    float: left;\r\n    margin-left: 5px;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > .nikas-comment-header .author {\r\n    color: #555;\r\n    font-size: 12px;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > .textarea-wrapper .textarea,\r\n.nikas-comment > div.text-wrapper > .textarea-wrapper .preview {\r\n    margin-top: 0.2em;\r\n    color: black;\r\n    direction: rtl;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > div.text p {\r\n    margin-top: 1em;\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    direction: rtl;\r\n    text-align: justify;\r\n    text-align-last: right;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > div.text p:last-child {\r\n    margin-bottom: 0.2em;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > div.text h1,\r\n.nikas-comment > div.text-wrapper > div.text h2,\r\n.nikas-comment > div.text-wrapper > div.text h3,\r\n.nikas-comment > div.text-wrapper > div.text h4,\r\n.nikas-comment > div.text-wrapper > div.text h5,\r\n.nikas-comment > div.text-wrapper > div.text h6 {\r\n    font-size: 130%;\r\n    font-weight: bold;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > div.textarea-wrapper .textarea,\r\n.nikas-comment > div.text-wrapper > div.textarea-wrapper .preview {\r\n    width: 100%;\r\n    border: 1px solid #f0f0f0;\r\n    border-radius: 2px;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > .nikas-comment-footer {\r\n    font-size: 0.8em;\r\n    color: gray !important;\r\n    clear: left;\r\n    margin-top: 10px;\r\n}\r\n\r\n.nikas-feedlink,\r\n.nikas-comment > div.text-wrapper > .nikas-comment-footer a {\r\n    font-weight: bold;\r\n    text-decoration: none;\r\n    padding-left: 0;\r\n    transition: 0.1s linear all;\r\n}\r\n\r\n.nikas-feedlink:hover,\r\n.nikas-comment > div.text-wrapper > .nikas-comment-footer a:hover {\r\n    color: #111111 !important;\r\n    text-shadow: #aaaaaa 0 0 1px !important;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > .nikas-comment-footer > a {\r\n    position: relative;\r\n    top: 0.2em;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > .nikas-comment-footer > a.edit,\r\n.nikas-comment > div.text-wrapper > .nikas-comment-footer > a.reply,\r\n.nikas-comment > div.text-wrapper > .nikas-comment-footer > a.delete {\r\n    padding-right: 1em;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > .nikas-comment-footer .votes {\r\n    color: gray;\r\n}\r\n\r\n.nikas-comment > div.text-wrapper > .nikas-comment-footer .upvote svg,\r\n.nikas-comment > div.text-wrapper > .nikas-comment-footer .downvote svg {\r\n    position: relative;\r\n    top: 0.2em;\r\n    margin-right: 3px;\r\n}\r\n\r\n.nikas-comment .nikas-postbox {\r\n    margin-top: 0.8em;\r\n}\r\n\r\n.nikas-comment.nikas-no-votes > * > .nikas-comment-footer span.votes {\r\n    display: none;\r\n}\r\n\r\n.nikas-postbox {\r\n    max-width: 68em;\r\n    margin: 0 auto 2em;\r\n    clear: right;\r\n}\r\n\r\n.nikas-postbox > .form-wrapper {\r\n    display: block;\r\n    padding: 0;\r\n}\r\n\r\n.nikas-postbox > .form-wrapper > .auth-section,\r\n.nikas-postbox > .form-wrapper > .auth-section .post-action {\r\n    display: block;\r\n}\r\n\r\n.nikas-postbox > .form-wrapper .textarea,\r\n.nikas-postbox > .form-wrapper .preview {\r\n    margin: 0 0 0.3em;\r\n    padding: 0.4em 0.8em;\r\n    border-radius: 3px;\r\n    background-color: #fff;\r\n    border: 1px solid rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.nikas-postbox > .form-wrapper input[type="checkbox"] {\r\n    vertical-align: middle;\r\n    position: relative;\r\n    bottom: 1px;\r\n    margin-left: 0;\r\n}\r\n\r\n.nikas-postbox > .form-wrapper .notification-section {\r\n    font-size: 0.9em;\r\n    padding-top: 0.3em;\r\n}\r\n\r\n#nikas-thread .textarea:focus,\r\n#nikas-thread input:focus {\r\n    border-color: rgba(0, 0, 0, 0.8);\r\n}\r\n\r\n.nikas-postbox > .form-wrapper > .auth-section .input-wrapper {\r\n    display: inline-block;\r\n    position: relative;\r\n    max-width: 25%;\r\n    margin: 0 5px 0 0;\r\n}\r\n\r\n.nikas-postbox > .form-wrapper > .auth-section .input-wrapper input {\r\n    padding: 0.3em 10px;\r\n    max-width: 100%;\r\n    border-radius: 3px;\r\n    background-color: #fff;\r\n    line-height: 1.4em;\r\n    border: 1px solid rgba(0, 0, 0, 0.2);\r\n    font-family: var(--font);\r\n    text-align: center;\r\n    font-size: 12px;\r\n    color: black;\r\n}\r\n\r\n.nikas-postbox > .form-wrapper > .auth-section .post-action {\r\n    float: right;\r\n    margin: 0 0 0 5px;\r\n}\r\n\r\n.nikas-postbox > .form-wrapper > .auth-section .post-action > input {\r\n    border-radius: 2px;\r\n    border: 1px solid #ccc;\r\n    background-color: #ddd;\r\n    cursor: pointer;\r\n    outline: 0;\r\n    line-height: 1.4em;\r\n    border-radius: 10px;\r\n    padding: 5px 10px 5px 10px;\r\n    transition: 0.2s linear all;\r\n    font-size: 12px;\r\n    margin-bottom: 0;\r\n}\r\n\r\n.nikas-postbox > .form-wrapper > .auth-section .post-action > input:hover {\r\n    background-color: #ccc;\r\n}\r\n\r\n.nikas-postbox > .form-wrapper > .auth-section .post-action > input:active {\r\n    background-color: #bbb;\r\n}\r\n\r\n.nikas-postbox > .form-wrapper .preview,\r\n.nikas-postbox > .form-wrapper input[name="edit"],\r\n.nikas-postbox.preview-mode > .form-wrapper input[name="preview"],\r\n.nikas-postbox.preview-mode > .form-wrapper .textarea {\r\n    display: none;\r\n}\r\n\r\n.nikas-postbox.preview-mode > .form-wrapper .preview {\r\n    display: block;\r\n}\r\n\r\n.nikas-postbox.preview-mode > .form-wrapper input[name="edit"] {\r\n    display: inline;\r\n}\r\n\r\n.nikas-postbox > .form-wrapper .preview {\r\n    background: #f8f8f8\r\n        repeating-linear-gradient(\r\n            -45deg,\r\n            #f8f8f8,\r\n            #f8f8f8 10px,\r\n            #fff 10px,\r\n            #fff 20px\r\n        );\r\n}\r\n\r\n.nikas-postbox > .form-wrapper > .notification-section {\r\n    display: none;\r\n    padding-bottom: 10px;\r\n}\r\n\r\n@media screen and (max-width: 600px) {\r\n    .nikas-postbox > .form-wrapper > .auth-section .input-wrapper {\r\n        display: block;\r\n        max-width: 100%;\r\n        margin: 0 0 0.3em;\r\n    }\r\n\r\n    .nikas-postbox > .form-wrapper > .auth-section .input-wrapper input {\r\n        width: 100%;\r\n    }\r\n}\r\n'}),define("app/text/css",["text!../../../css/nikas.css"],function(e){return{inline:e}}),define("text!app/text/arrow-down.svg",[],function(){return'\x3c!-- Generator: IcoMoon.io --\x3e<svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">\r\n  <g>\r\n    <path d="M 24.773,13.701c-0.651,0.669-7.512,7.205-7.512,7.205C 16.912,21.262, 16.456,21.44, 16,21.44c-0.458,0-0.914-0.178-1.261-0.534 c0,0-6.861-6.536-7.514-7.205c-0.651-0.669-0.696-1.87,0-2.586c 0.698-0.714, 1.669-0.77, 2.522,0L 16,17.112l 6.251-5.995 c 0.854-0.77, 1.827-0.714, 2.522,0C 25.47,11.83, 25.427,13.034, 24.773,13.701z">\r\n    </path>\r\n  </g>\r\n</svg>\r\n'}),define("text!app/text/arrow-up.svg",[],function(){return'\x3c!-- Generator: IcoMoon.io --\x3e<svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">\r\n  <g>\r\n    <path d="M 24.773,18.299c-0.651-0.669-7.512-7.203-7.512-7.203C 16.912,10.739, 16.456,10.56, 16,10.56c-0.458,0-0.914,0.179-1.261,0.536 c0,0-6.861,6.534-7.514,7.203c-0.651,0.669-0.696,1.872,0,2.586c 0.698,0.712, 1.669,0.77, 2.522,0L 16,14.89l 6.251,5.995 c 0.854,0.77, 1.827,0.712, 2.522,0C 25.47,20.17, 25.427,18.966, 24.773,18.299z">\r\n    </path>\r\n  </g>\r\n</svg>\r\n'}),define("app/text/svg",["text!./arrow-down.svg","text!./arrow-up.svg"],function(e,t){return{"arrow-down":e,"arrow-up":t}}),require(["app/lib/ready","app/config","app/i18n","app/api","app/nikas","app/count","app/dom","app/text/css","app/text/svg","app/jade"],function(e,t,n,r,i,a,o,s,c,l){"use strict";function p(){if(d=o("#nikas-thread"),f=o.new("h4"),t.css&&null===o("style#nikas-style")){var e=o.new("style");e.id="nikas-style",e.type="text/css",e.textContent=s.inline,o("head").append(e)}if(a(),null===d)return console.log("abort, #nikas-thread is missing");if(t.feed){var c=o.new("a",n.translate("atom-feed")),l=o.new("span.nikas-feedlink");c.href=r.feed(d.getAttribute("data-nikas-id")),l.appendChild(c),d.append(l)}d.append(f),d.append(new i.Postbox(null)),d.append('<div id="nikas-root"></div>')}function u(){0!=o("#nikas-root").length&&(o("#nikas-root").textContent="",r.fetch(d.getAttribute("data-nikas-id")||location.pathname,t["max-comments-top"],t["max-comments-nested"]).then(function(e){if(0===e.total_replies)return void(f.textContent=n.translate("no-comments"));var t=0,r=e.total_replies;e.replies.forEach(function(e){i.insert(e,!1),e.created>t&&(t=e.created),r+=e.total_replies}),f.textContent=n.pluralize("num-comments",r),e.hidden_replies>0&&i.insert_loader(e,t),window.location.hash.length>0&&window.location.hash.match("^#nikas-[0-9]+$")&&o(window.location.hash).scrollIntoView()},function(e){console.log(e)}))}l.set("conf",t),l.set("i18n",n.translate),l.set("pluralize",n.pluralize),l.set("svg",c);var d,f;e(function(){p(),u()}),window.Nikas={init:p,fetchComments:u}}),define("embed",function(){})}();